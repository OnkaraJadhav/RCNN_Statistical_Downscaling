# ğŸ“ rcnn_model/

This module implements a **Residual Convolutional Neural Network (RCNN)** â€” specifically a U-Net â€” to learn fine-scale patterns. It takes interpolated sea surface temperature (SST) data as input and downscale it to the fine grid.

It consumes the ".p" files generated by the "interpolation-engine/" and trains a model to enhance downscaled SST accuracy based on multiple oceanic and atmospheric inputs.

---

## ğŸ§  Problem Statement

> Given coarse-resolution interpolated climate variables (e.g., SST), train a U-Net to predict high-resolution SST fields over the Western Australian coast.

---

## ğŸ§© Components

| File | Description |
|------|-------------|
| `scripts/train.py` | Trains the U-Net model on patch-based data. |
| `scripts/test_full_inference.py` | Evaluates full-image predictions and computes error metrics. |
| `scripts/data_utils.py` | Loads ".p" data, applies scaling, creates patches, and splits train/val sets. |
| `scripts/model.py` | Defines the U-Net architecture with masking support. |
| `scripts/config.py` | Stores all training parameters, paths, and flags. |

---

## ğŸ“¥ Inputs

- ".p" files from interpolation-engine/


## ğŸ§ª How to Run

### âœ… Train the Model

python scripts/train.py

This will:
Scale inputs
Train with early stopping & LR scheduling
Save weights, model JSON, and scalers to output/

### âœ… Evaluate on Full Images

python scripts/test_full_inference.py

This will:
Load test data
Reapply trained scalers
Predict full SST maps and compute RMSE/MAE

Save all results to: output/test_full_results.pkl

### ğŸ“‚ Output Files
File	Purpose
unet_weights.h5	#Final model weights
scalers.pkl	#Scikit-learn scalers used for normalization
unet_model.json	#Model architecture
test_full_results.pkl	#Dict containing predictions, metrics, filenames

## âš™ï¸ Configuration
All paths and hyperparameters live in:

scripts/config.py
You can override DATA_PATH, PATCH_SIZE, EPOCHS, etc.
The script will auto-create output/ if missing.

## ğŸ§  Features
âœ… Mixed precision support

âœ… Mask-aware loss (only predict on ocean pixels)

âœ… Patch-based training (for memory efficiency)

âœ… Full image inference with proper scaling and evaluation

Dependencies:

tensorflow
scikit-learn
numpy
xarray
